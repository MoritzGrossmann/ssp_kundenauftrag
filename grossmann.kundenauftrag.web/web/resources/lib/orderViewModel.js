function CustomerViewModel(e){this.id=ko.observable(e.id),this.name=ko.observable(e.firstname+" "+e.lastname)}function OrderItemViewModel(e,o,t,d){var r=this;r.id=ko.observable(e),r.productId=ko.observable(o),r.count=ko.observable(t),r.delete=function(){d(r)}}function OrderViewModel(e,o){var t=this;t.id=ko.observable(e),t.dateTime=ko.observable(""),t.customer=ko.observable(),t.orderItems=ko.observableArray([]),t.count=ko.observable(0),t.productId=ko.observable(0),t.deleteOrderItem=function(e){$.ajax({method:"DELETE",url:o+"/api/order/"+t.id()+"/items/"+e.id()}).done(function(o){t.orderItems.remove(e)})},t.getData=function(){$.ajax({method:"GET",url:o+"/api/order/"+t.id()}).done(function(e){if(e){t.dateTime(e.dateTime);var o=[];e.orderItems.forEach(function(e){o[o.length]=new OrderItemViewModel(e.id,e.productId,e.count,t.deleteOrderItem)}),t.orderItems(o),t.getCustomer()}})},t.getCustomer=function(){$.ajax({method:"GET",url:o+"/api/order/"+t.id()+"/customer"}).done(function(e){t.customer(new CustomerViewModel(e))})},t.addOrderItem=function(){if(t.productId()<1||t.count()<1)alert("prodct and count must be positive");else{var e={productId:t.productId(),count:t.count()};$.ajax({method:"POST",url:o+"/api/order/"+t.id(),data:JSON.stringify(e),headers:{Accept:"application/json","Content-Type":"application/json"}}).done(function(e){t.orderItems.push(new OrderItemViewModel(e.id,e.productId,e.count,t.deleteOrderItem)),t.productId(0),t.count(0)})}},t.getData()}$(function(){var e=document.getElementById("baseUrl").firstChild.nodeValue,o=new OrderViewModel(document.getElementById("orderId").firstChild.nodeValue,e);ko.applyBindings(o,document.getElementById("order"))});